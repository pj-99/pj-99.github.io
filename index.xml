<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>PJ's Blog â€“ PJ's blog</title><link>https://pj-99.github.io/</link><description>Recent content in PJ's blog on PJ's Blog</description><generator>Hugo -- gohugo.io</generator><language>en</language><atom:link href="https://pj-99.github.io/index.xml" rel="self" type="application/rss+xml"/><item><title>AWS Lambda çš„ç¶²è·¯èƒ½åŠ›å’Œ Lambda å¦‚ä½•å­˜å–å¤–ç¶²å’Œ VPC</title><link>https://pj-99.github.io/blog/aws/lambda/lambda_access_internet_and_vpc/</link><pubDate>Wed, 08 Jan 2025 00:00:00 +0000</pubDate><guid>https://pj-99.github.io/blog/aws/lambda/lambda_access_internet_and_vpc/</guid><description>
&lt;p>Lambda çš„ç¶²è·¯èƒ½åŠ›å¯ä»¥åˆ†ç‚ºå…©ç¨®ï¼Œæœ‰é€£æ¥åˆ° VPC æˆ–æ²’æœ‰ã€‚&lt;/p>
&lt;p>æœ€è¿‘åšå°ˆæ¡ˆæ™‚ï¼Œæƒ³å˜—è©¦ç”¨ Lambda å°‡ç¬¬ä¸‰æ–¹ API å›å‚³çš„è³‡æ–™å­˜å…¥ VPC å…§çš„ RDSï¼Œä½†åœ¨éç¨‹ä¸­ç™¼ç¾ï¼Œåœ¨é è¨­ï¼ˆæ²’æœ‰ç‰¹åˆ¥è¨­å®š NAT ç­‰ã€æ²’æœ‰ä»€éº¼é ç®—ï¼‰çš„æƒ…æ³ä¸‹ï¼Œç„¡æ³•ç›´æ¥è®“ä¸€å€‹ Lambda åŒæ™‚å­˜å–å¤–ç¶²æœå‹™åˆå­˜å– VPCï¼Œç¶“éä¸€ç•ªæ™æ‰ï¼Œæœ€å¾Œé€éã€Œå°‡äº‹æƒ…åˆ†çµ¦ä¸åŒ Lambda é‚„æœ‰ç”¨ Lambda destination å‚³è³‡æ–™ã€ä¾†è§£æ±ºé€™å€‹å•é¡Œã€‚&lt;/p>
&lt;p>é€™ç¯‡æœƒå…ˆç°¡å–®ä»‹ç´¹ AWS Lambda çš„ç¶²è·¯èƒ½åŠ›ï¼Œå†ä»‹ç´¹ Lambda å­˜å–å¤–ç¶²å’Œ VPC çš„ä¸€ç¨®æ–¹æ³•ã€‚&lt;/p>
&lt;h2>AWS Lambda çš„ç¶²è·¯èƒ½åŠ›: attach-VPC or no-VPC&lt;span class="hx-absolute -hx-mt-20" id="aws-lambda-çš„ç¶²è·¯èƒ½åŠ›-attach-vpc-or-no-vpc">&lt;/span>
&lt;a href="#aws-lambda-%e7%9a%84%e7%b6%b2%e8%b7%af%e8%83%bd%e5%8a%9b-attach-vpc-or-no-vpc" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>åœ¨è¨­å®š Lambda æ™‚ï¼Œæœ‰å€‹é¸é …æ˜¯ &lt;code>Enable VPC&lt;/code>ï¼Œæ‰“é–‹ä¹‹å¾Œå°±å¯ä»¥é¸è¦è®“ Lambda é€£æ¥åˆ°å“ªå€‹ VPCï¼Œé€éé€™å€‹è¨­å®šå°±èƒ½è®“ Lambda å­˜å–åˆ° VPC å…§çš„è³‡æºã€‚
&lt;img src="https://pj-99.github.io/attachments/VPC_internet_lambda_enable_VPC.png" alt="" loading="lazy" />
ä¸€é–‹å§‹åœ¨è¶•è‘—å¯¦ä½œå‡ºå°ˆæ¡ˆåŠŸèƒ½æ™‚ï¼Œé‚„ä»¥ç‚ºæŠŠé€™å€‹ &lt;code>Enable VPC&lt;/code> å‹¾å‹¾èµ·ä¾†ï¼Œå°±åƒæ˜¯æŠŠ Lambda æ”¾åœ¨ VPC å…§ï¼Œå¾Œä¾†çœ‹åˆ°å®˜æ–¹è³‡æ–™èˆ‡å…¶ä»–å¤§å¤§çš„æ•´ç†ï¼Œæ‰ç™¼ç¾å…¶å¯¦èƒŒå¾Œç™¼ç”Ÿçš„äº‹æƒ…ä¸¦ä¸æ˜¯æƒ³åƒçš„é€™æ¨£ï¼Œèƒ½å¤ å­˜å– VPC çš„ Lambda æ²’æœ‰çœŸçš„æ”¾åœ¨ VPC å…§ï¼Œè€Œæ˜¯å®ƒå¯ä»¥&lt;strong>é€£æ¥åˆ° VPC&lt;/strong> (attach-VPC)ã€‚&lt;/p>
&lt;p>ä»¥ä¸‹ä½¿ç”¨çš„ç¤ºæ„åœ–ä¾†æºç‚º &lt;a href="https://d1.awsstatic.com/events/reinvent/2020/AWS_Lambda_networking_best_practices_SVS312.pdf" target="_blank" rel="noopener">AWS re:Invent 2020 AWS Lambda networking best practices&lt;/a>ï¼Œè£¡é¢æœ‰è¨±å¤šé—œæ–¼ Lambda networking è©³ç›¡ä¸”é™„åœ–çš„ä»‹ç´¹ï¼Œæ¨æ¨ã€‚&lt;/p>
&lt;p>é¦–å…ˆéœ€è¦çŸ¥é“çš„èƒŒæ™¯çŸ¥è­˜æ˜¯ï¼Œæ‰€æœ‰çš„ Lambda éƒ½è¢«æ”¾åœ¨ AWS ç®¡ç†çš„ Lambda service VPC ä¸­åŸ·è¡Œï¼Œå‘¼å« Lambda éƒ½æ˜¯çµ±ä¸€é€é Lambda service APIï¼š
&lt;img src="https://pj-99.github.io/attachments/Lambda_services_VPC.png" alt="Lambda Services VPC" width="300">&lt;/p>
&lt;p>è€Œ Lambda çš„ç¶²è·¯é€£ç·šèƒ½åŠ›åˆ†ç‚ºå…©ç¨®ï¼Œå¦‚ä¸‹é¢é€™å¼µåœ–çš„ no-VPC æˆ–æ˜¯é€£æ¥ VPCã€‚&lt;/p>
&lt;img src="https://pj-99.github.io/attachments/Lambda_networking_modes.png">
&lt;p>é è¨­çš„ no-VPC æ¨¡å¼è®“ Lambda å¯ä»¥å­˜å–ç¶²éš›ç¶²è·¯ä¸Šçš„æ±è¥¿ï¼Œä¸èƒ½å­˜å– VPC çš„è³‡æºï¼ˆç•¢ç«Ÿæ˜¯ Virtual &lt;strong>private&lt;/strong> cloudï¼‰ã€‚&lt;/p>
&lt;p>è€Œå°‡ &lt;code>Enable VPC&lt;/code> æ¨¡å¼æ‰“å‹¾å¾Œï¼ŒLambda é‚„æ˜¯æœƒè¢«æ”¾åœ¨ Lambda service VPC è£¡ï¼Œä½†æ˜¯é€™å€‹ Lambda çš„æ‰€æœ‰ç¶²è·¯æµé‡éƒ½æœƒè¢«å°åˆ°é¸æ“‡çš„ VPCï¼Œä¹Ÿå› æ­¤å¦‚æœ VPC æ²’æœ‰ç‰¹åˆ¥è¨­å®šï¼ˆåƒæ˜¯ NAT ç­‰ç­‰ï¼‰ï¼Œé‚£éº¼é€™å€‹ Lambda æ˜¯ä¸èƒ½è·Ÿå¤–ç¶²è³‡æºæºé€šçš„ã€‚&lt;/p>
&lt;ul>
&lt;li>ä¸­é–“ç™¼ç”Ÿäº†ä»€éº¼äº‹æƒ…å¯ä»¥çœ‹ &lt;a href="https://d1.awsstatic.com/events/reinvent/2020/AWS_Lambda_networking_best_practices_SVS312.pdf" target="_blank" rel="noopener">AWS Lambda networking best practices&lt;/a> çš„è©³ç›¡ä»‹ç´¹&lt;/li>
&lt;/ul>
&lt;h2>AWS Lambda å¦‚ä½•å­˜å–å¤–ç¶²å’Œ VPC&lt;span class="hx-absolute -hx-mt-20" id="aws-lambda-å¦‚ä½•å­˜å–å¤–ç¶²å’Œ-vpc">&lt;/span>
&lt;a href="#aws-lambda-%e5%a6%82%e4%bd%95%e5%ad%98%e5%8f%96%e5%a4%96%e7%b6%b2%e5%92%8c-vpc" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>é‚£éº¼æ²’æœ‰é ç®—å¯ä»¥é–‹ NAT çš„æƒ…æ³ä¸‹ï¼Œè©²æ€éº¼åšæ‰èƒ½è®“ Lambda å¯ä»¥å­˜å–å¤–ç¶²ã€åˆå­˜å– VPC å‘¢ï¼Ÿ&lt;/p>
&lt;p>Google äº†ä¸€é™£å­ï¼Œå¾ä¸€ä½å¤§å¤§åˆ†äº«çš„ &lt;a href="https://3lexw.medium.com/aws-%E6%9C%AD%E8%A8%98-3-%E5%88%A9%E7%94%A8-aws-s3-%E4%BD%9C%E7%82%BA-aws-lambda-%E5%87%BD%E6%95%B8%E4%B9%8B%E9%96%93%E7%9A%84%E4%B8%AD%E8%BD%89%E7%AB%99-982d40e6e20f" target="_blank" rel="noopener">AWS Lambda åšç¶²è·¯çˆ¬èŸ²&lt;/a>çš„æ–‡ç« èªè­˜åˆ° Lambda destination å¯ä»¥ç”¨ä¾†å‚³é Lambda ä¹‹é–“çš„è³‡æ–™ï¼Œä¹Ÿçœ‹åˆ°å¯ä»¥å°‡ Lambda æ‰“å¤–ç¶²çš„çµæœå­˜åœ¨ s3 ä¸Šï¼Œå†ç”¨å¦ä¸€å€‹ Lambda å¾ s3 è®€æª”åšé€²ä¸€æ­¥è™•ç†ã€‚&lt;/p>
&lt;p>å¾é€™æµç¨‹å­¸åˆ°ä¸€ç¨®åšæ³•æ˜¯ï¼šä¸è¦åªä¾·é™ä¸€å€‹ Lambdaï¼Œä¸­é–“çš„è³‡æ–™å‚³éå»å°±å¥½ã€‚ç¾å…¶åé‚„å¯ä»¥è¦–ä½œã€Œè§£è€¦ Lambdaã€ğŸ˜¼&lt;/p>
&lt;p>å›åˆ°è¦å°‡å¤–ç¶²è³‡æ–™å­˜å› RDS çš„ç›®æ¨™ï¼Œæˆ‘å°‡ã€Œå­˜å–ç¶²è·¯è³‡æ–™ã€èˆ‡ã€Œå¯«å…¥ DB ã€åˆ†é–‹ï¼šå­˜å–å¤–ç¶²çš„äº‹çµ¦ no-VPC çš„ Lambda åšï¼Œå¯« DB çš„äº‹å°±çµ¦ VPC çš„ Lambda åšï¼Œä¹Ÿç”¨ s3 ä¾†å„²å­˜ä¸­é–“ç”¢ç‰©ã€‚&lt;/p>
&lt;p>ä½†è·Ÿä¸Šé¢æ–‡ç« ä¸ä¸€æ¨£çš„æ˜¯ï¼Œæˆ‘ä¸æ˜¯è¨­å®š s3 æœƒ trigger ç¬¬äºŒå€‹ Lambdaï¼Œè€Œæ˜¯è®“ç¬¬ä¸€å€‹ Lambda é€é Lambda destination è§¸ç™¼ç¬¬äºŒå€‹ Lambdaï¼Œç¬¬äºŒå€‹ Lambda å†ä¸»å‹•å¾ s3 ä¸‹è¼‰æª”æ¡ˆã€‚&lt;/p>
&lt;p>é€™æ¨£çš„åšæ³•éœ€è¦é¡å¤–è¨­å®š VPC çš„ s3 &lt;a href="https://docs.aws.amazon.com/vpc/latest/privatelink/gateway-endpoints.html" target="_blank" rel="noopener">gateway endpoint&lt;/a>ï¼Œè®“ VPC çš„ç¶²è·¯æµé‡ä¸ç”¨ç¶“éå¤–ç¶²å†åˆ° s3ï¼Œè€Œæ˜¯é€é gateway endpoint ç›´æ¥å‚³åˆ° s3ã€‚&lt;/p>
&lt;ul>
&lt;li>s3 å’Œ dynamo DB æ˜¯ AWS æœå‹™ä¸­å°‘æ•¸å¯ä»¥å…è²»åœ¨ VPC ä¸­ä½¿ç”¨ gateway endpoint çš„æœå‹™ã€‚&lt;/li>
&lt;/ul>
&lt;p>æ•´é«”æµç¨‹å¦‚ä¸‹åœ–ï¼Œ&lt;del>æƒ³ä¸å¤ªèµ·ä¾†è‡ªå·±ç‚ºä»€éº¼é€™æ¨£åšè€Œä¸æ˜¯åƒä¸Šé¢æ–‡ç« ç›´æ¥å¾ s3 trigger&lt;/del>&lt;/p>
&lt;img src="https://pj-99.github.io/attachments/VPC_internet_lambda_s3.png" width="500">
&lt;p>ç¸½ä¹‹é€™å€‹æµç¨‹æ˜¯å¯ä»¥æ­£å¸¸é‹ä½œçš„ï¼Œä½†æ˜¯å¾Œä¾†è€ƒé‡åˆ°æˆ‘å€‘å°ˆæ¡ˆçš„éœ€æ±‚ï¼Œé€™æ¢æµç¨‹æ¯ 10 åˆ†é˜å°±æœƒè¢«è§¸ç™¼ä¸€æ¬¡ï¼Œä¸€å€‹æœˆå°±æœƒ PUT 4300 å¤šæ¬¡ï¼Œå› æ­¤é€™æ¨£æœƒç”¨å…‰å…è²»æ–¹æ¡ˆæä¾›çš„ä¸€å€‹æœˆ 2000 æ¬¡çš„ PUTï¼Œä¸æ˜¯å€‹é©åˆæ²’æœ‰ä»€éº¼é ç®—çš„æ–¹æ³•ã€‚&lt;/p>
&lt;p>æ–¼æ˜¯ç¶“éç ”ç©¶ï¼Œåˆèª¿æ•´äº†ä¸€ä¸‹æµç¨‹ï¼Œç›´æ¥ç”¨ &lt;strong>Lambda destination&lt;/strong> é€™å€‹åŠŸèƒ½ä¾†å‚³ä¸­é–“ç”¢ç‰©ã€‚&lt;/p>
&lt;h2>Lambda destination: å°‡ Lambda çµæœå‚³ä¸‹å»&lt;span class="hx-absolute -hx-mt-20" id="lambda-destination-å°‡-lambda-çµæœå‚³ä¸‹å»">&lt;/span>
&lt;a href="#lambda-destination-%e5%b0%87-lambda-%e7%b5%90%e6%9e%9c%e5%82%b3%e4%b8%8b%e5%8e%bb" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>Lambda destination å¯ä»¥å°‡ Lambda çš„åŸ·è¡Œçµæœå‚³éçµ¦å¦ä¸€å€‹æœå‹™ï¼Œé‚„å¯ä»¥è¨­å®šç•¶æˆåŠŸå†å‚³æˆ–æ˜¯å¤±æ•—æ™‚å†å‚³ï¼Œç›®å‰å¯ä»¥å‚³éçš„ç›®æ¨™æœå‹™åŒ…å«ï¼šSNS, SQS, Lambda, EventBridgeã€‚&lt;/p>
&lt;p>èˆ‰ä¾‹ä¾†èªªï¼Œä½ å¯ä»¥è¨­å®šæŸå€‹è¦ç›£æ§çš„ A Lambda æœ‰ä¸€æ¢ on Failure çš„ destination åˆ°å¦ä¸€å€‹é€šçŸ¥ç”¨çš„ Lambdaï¼Œè‹¥ A Lambda æŸå¤©åŸ·è¡Œå¤±æ•—ï¼Œå°±æœƒå°‡å¤±æ•—çš„çµæœå‚³éçµ¦æœƒç™¼é€šçŸ¥çš„ Lambdaã€‚&lt;/p>
&lt;p>ä½†ä½¿ç”¨ Lambda destination æ™‚è¦æ³¨æ„ï¼š&lt;/p>
&lt;ul>
&lt;li>Lambda çš„å‘¼å«æ–¹å¼æœ‰åˆ† sync å’Œ asyncï¼Œå¯ä»¥ç”¨ã€Œéœ€ä¸éœ€è¦ç«‹åˆ»å¾—åˆ°å›å‚³å€¼ã€ä¾†åˆ¤æ–·æ˜¯å“ªç¨®ï¼Œ&lt;strong>åªæœ‰ async å‘¼å«æ–¹å¼æœƒè§¸ç™¼ lambda destination&lt;/strong>ï¼Œæ‰€è§¸ç™¼çš„å¦ä¸€å€‹ lambda ä¹Ÿæ˜¯ async å‘¼å«ã€‚
&lt;ul>
&lt;li>ä¾‹å¦‚ï¼Œåœ¨ AWS console ç”¨ test æˆ³å®ƒæ˜¯ syncï¼Œæ‰€ä»¥ä¸æœƒè§¸ç™¼ lambda destinationã€‚è¢« EventBridge çš„ event è§¸ç™¼å‰‡æ˜¯ asyncã€‚&lt;/li>
&lt;li>è©³ç´°å¯ä»¥åƒè€ƒé€™ç¾¤å¤§å¤§çš„æ•´ç†: &lt;a href="https://www.trek10.com/blog/lambda-destinations-what-we-learned-the-hard-way" target="_blank" rel="noopener">lambda-destinations-what-we-learned-the-hard-way&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>å¦‚æœç›®æ¨™æœå‹™æ˜¯å¦ä¸€å€‹ Lambdaï¼Œé‚£ payload å°±æœƒå—é™æ–¼ &lt;a href="https://docs.aws.amazon.com/lambda/latest/dg/gettingstarted-limits.html" target="_blank" rel="noopener">Lambda async invocation payload çš„é™åˆ¶&lt;/a>ï¼Œ&lt;strong>payload ä¸Šé™åªæœ‰ 256 KB&lt;/strong>ã€‚&lt;/li>
&lt;/ul>
&lt;p>ç‚ºäº†è®“ payload ä¸è¦å¤ªå¤§ï¼Œå¯ä»¥å£“ç¸®è³‡æ–™ã€‚&lt;/p>
&lt;p>åƒæ˜¯æˆ‘å€‘å°ˆæ¡ˆä½¿ç”¨äº† gzip ä¾†å£“ç¸®ï¼Œä¾‹å¦‚åŸæœ¬çš„ JSON æ˜¯ 279 KB ï¼Œé€é gzip å£“ç¸®ï¼Œå¯ä»¥é™ä½åˆ° 19 KBã€‚&lt;/p>
&lt;p>æœ€çµ‚å¯¦ä½œçš„æµç¨‹å…¶å¯¦å¾ˆç°¡å–®ï¼Œå¦‚ä¸‹åœ–ï¼šno-VPC Lambda å…ˆæ‰“å¤–ç¶²ï¼Œå°‡è³‡æ–™å£“ç¸®ä¸¦å›å‚³ï¼Œå†é€é Lambda destination å°‡è³‡æ–™å‚³éçµ¦ VPC Lambdaï¼Œæœ€å¾Œå†èˆ‡ VPC å…§çš„è³‡æºæºé€šã€‚&lt;/p>
&lt;img src="https://pj-99.github.io/attachments/VPC_internet_lambda_destination.png" width="500">
&lt;h2>å°çµ&lt;span class="hx-absolute -hx-mt-20" id="å°çµ">&lt;/span>
&lt;a href="#%e5%b0%8f%e7%b5%90" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>ç¶²è·¯ä¸Šé‚„æœ‰è¨±å¤šé—œæ–¼é€™å€‹å•é¡Œçš„è±å¯Œè¨è«–èˆ‡æ–¹æ³•æ¯”è¼ƒï¼Œé€™ç¯‡æåˆ°çš„åªæ˜¯å…¶ä¸­ä¸€ç¨®åšæ³•ï¼Œåƒæ˜¯å¦‚æœä½ è¦å­˜å–å¤–ç¶²åªæ˜¯ç‚ºäº†ç”¨ AWS æœ¬èº«æœå‹™çš„è©±ï¼Œé‚£å¾ˆé«˜æ©Ÿç‡æœƒæœ‰å…¶ä»–æ›´é©åˆçš„æ–¹æ³•ã€‚&lt;/p>
&lt;p>ä½†å¦‚æœä½ çš„éœ€æ±‚å’Œé€™ç¯‡æè¿°çš„æƒ…å¢ƒé¡ä¼¼ï¼Œæ˜¯ async è§¸ç™¼çš„ã€è¦å­˜å–ç¬¬ä¸‰æ–¹æœå‹™ã€è³‡æ–™ä¸å¤§ï¼Œé‚£æ‹†åˆ†æˆå…©å€‹ Lambda ä¸¦é€é destination å‚³éæˆ–è¨±æ˜¯å€‹ç°¡å–®çš„é¸æ“‡ã€‚&lt;/p>
&lt;h2>References&lt;span class="hx-absolute -hx-mt-20" id="references">&lt;/span>
&lt;a href="#references" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;ul>
&lt;li>&lt;a href="https://d1.awsstatic.com/events/reinvent/2020/AWS_Lambda_networking_best_practices_SVS312.pdf" target="_blank" rel="noopener">https://d1.awsstatic.com/events/reinvent/2020/AWS_Lambda_networking_best_practices_SVS312.pdf&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://stackoverflow.com/questions/52992085/why-cant-an-aws-lambda-function-inside-a-public-subnet-in-a-vpc-connect-to-the" target="_blank" rel="noopener">https://stackoverflow.com/questions/52992085/why-cant-an-aws-lambda-function-inside-a-public-subnet-in-a-vpc-connect-to-the&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://medium.com/@arunasilva86/how-to-use-vpc-networking-effectively-for-lambda-445abefdf8cf" target="_blank" rel="noopener">https://medium.com/@arunasilva86/how-to-use-vpc-networking-effectively-for-lambda-445abefdf8cf&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://aws.amazon.com/tw/blogs/compute/announcing-improved-vpc-networking-for-aws-lambda-functions/" target="_blank" rel="noopener">https://aws.amazon.com/tw/blogs/compute/announcing-improved-vpc-networking-for-aws-lambda-functions/&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://aws.amazon.com/tw/blogs/compute/using-aws-lambda-iam-condition-keys-for-vpc-settings/" target="_blank" rel="noopener">https://aws.amazon.com/tw/blogs/compute/using-aws-lambda-iam-condition-keys-for-vpc-settings/&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://3lexw.medium.com/aws-%E6%9C%AD%E8%A8%98-3-%E5%88%A9%E7%94%A8-aws-s3-%E4%BD%9C%E7%82%BA-aws-lambda-%E5%87%BD%E6%95%B8%E4%B9%8B%E9%96%93%E7%9A%84%E4%B8%AD%E8%BD%89%E7%AB%99-982d40e6e20f" target="_blank" rel="noopener">https://3lexw.medium.com/aws-%E6%9C%AD%E8%A8%98-3-%E5%88%A9%E7%94%A8-aws-s3-%E4%BD%9C%E7%82%BA-aws-lambda-%E5%87%BD%E6%95%B8%E4%B9%8B%E9%96%93%E7%9A%84%E4%B8%AD%E8%BD%89%E7%AB%99-982d40e6e20f&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Git - How to merge two repositories into one using git subtree add</title><link>https://pj-99.github.io/blog/git/merge_two_repos/</link><pubDate>Mon, 30 Sep 2024 00:00:00 +0000</pubDate><guid>https://pj-99.github.io/blog/git/merge_two_repos/</guid><description>
&lt;h2>How to merge two repositories into one&lt;span class="hx-absolute -hx-mt-20" id="how-to-merge-two-repositories-into-one">&lt;/span>
&lt;a href="#how-to-merge-two-repositories-into-one" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>ä¾‹å¦‚ä½ å·²ç¶“é–‹ç™¼ä¸€å€‹ web ä¸€æ®µæ™‚é–“ï¼Œæœ‰ä¸€å€‹ backend çš„ repo å’Œä¸€å€‹ frontend çš„ repoï¼Œç¾åœ¨æƒ³è¦å°‡å®ƒå€‘åˆä½µæˆä¸€å€‹ repoï¼Œåˆä¸æƒ³å®Œå…¨å¤±å»ä¹‹å‰çš„æ­·å²è¨˜éŒ„ï¼Œå°±å¯ä»¥ç”¨ &lt;code>git subtree add&lt;/code> åŠ å…¥æŒ‡å®š repo çš„ commit treeã€‚&lt;/p>
&lt;h2>git subtree add&lt;span class="hx-absolute -hx-mt-20" id="git-subtree-add">&lt;/span>
&lt;a href="#git-subtree-add" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">git subtree add -P &amp;lt;prefix&amp;gt; add &amp;lt;repository&amp;gt; &amp;lt;remote-ref&amp;gt;&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;ul>
&lt;li>&lt;code>&amp;lt;prefix&amp;gt;&lt;/code>: è¦æ”¾åœ¨å“ªå€‹ subdirectory&lt;/li>
&lt;li>&lt;code>&amp;lt;repository&amp;gt;&lt;/code>: repository link&lt;/li>
&lt;li>&lt;code>&amp;lt;remote-ref&amp;gt;&lt;/code>: branch&lt;/li>
&lt;/ul>
&lt;h2>Example&lt;span class="hx-absolute -hx-mt-20" id="example">&lt;/span>
&lt;a href="#example" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Go to your new project folder and init git&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;# my_project&amp;#34;&lt;/span> &amp;gt;&amp;gt; README.md
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">git init
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># You must have one commit to use git subtree add&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">git add README.md
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">git commit -m &lt;span class="s2">&amp;#34;first commit&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># For example, put the backend repo into the backend folder&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">git subtree add -P backend https://github.com/path_to_backend.git main
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># And frontend folder&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">git subtree add -P frontend https://github.com/path_to_frontend.git main&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;h2>Ref&lt;span class="hx-absolute -hx-mt-20" id="ref">&lt;/span>
&lt;a href="#ref" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;ul>
&lt;li>&lt;a href="https://stackoverflow.com/a/32684526/19055115" target="_blank" rel="noopener">https://stackoverflow.com/a/32684526/19055115&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/git/git/blob/master/contrib/subtree/git-subtree.txt" target="_blank" rel="noopener">git subtree&lt;/a>
&lt;ul>
&lt;li>é™¤äº† add é‚„æœ‰ merge ã€split ç­‰ç­‰å„ç¨®é€²éšçš„ç”¨æ³•&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul></description></item><item><title>Go - Channels</title><link>https://pj-99.github.io/blog/go/go_channels/</link><pubDate>Mon, 23 Sep 2024 00:00:00 +0000</pubDate><guid>https://pj-99.github.io/blog/go/go_channels/</guid><description>
&lt;h2>Channel&lt;span class="hx-absolute -hx-mt-20" id="channel">&lt;/span>
&lt;a href="#channel" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>Channel æ˜¯å€‹ typed çš„ç®¡é“ï¼Œgo ç¨‹å¼å¯ä»¥é€é channel operator &lt;code>&amp;lt;-&lt;/code> å»æ¥å—æˆ–ç™¼é€æŸå€‹å€¼ã€‚é€é channel å¯ä»¥åŒæ­¥ä¸åŒçš„ Goroutineã€‚&lt;/p>
&lt;p>ç®­é ­çš„æ–¹å‘å°±ä»£è¡¨äº†è³‡æ–™çš„å‚³è¼¸æ–¹å‘ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">ch&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">make&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kd">chan&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// create a channel for int
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="nx">v&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">100&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">go&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Sending v to channel&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">ch&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nx">v&lt;/span> &lt;span class="c1">// Send value to the channel
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">recv&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nx">ch&lt;/span> &lt;span class="c1">// Get value from the channel
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;recv: %v&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">recv&lt;/span>&lt;span class="p">)&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>é è¨­æƒ…æ³ä¸‹ï¼Œæ¥å—èˆ‡ç™¼é€éƒ½æœƒ block ä½ï¼Œç›´åˆ°å¦ä¸€ç«¯ä¹Ÿç™¼é€æˆ–æ¥å—ï¼Œåƒæ˜¯ä»¥ä¸‹çš„ç¨‹å¼æœƒåœåœ¨ &lt;code>ch &amp;lt;- v&lt;/code>ï¼Œå› ç‚ºç¨‹å¼é‚„åœ¨ç­‰äººç™¼é€å€¼åˆ° channel ä¸­ï¼Œæœƒå‡ºç¾ deadlock éŒ¯èª¤ &lt;code>fatal error: all goroutines are asleep - deadlock!&lt;/code>ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">ch&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">make&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kd">chan&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// create a channel for int
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="nx">v&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">100&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Sending v to channel&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">ch&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nx">v&lt;/span> &lt;span class="c1">// The code will stop here and wait for the value...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">recv&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nx">ch&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;recv: %v&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">recv&lt;/span>&lt;span class="p">)&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>channel çš„ block è¡Œç‚ºæ˜¯å¯ä»¥è¢«æ§åˆ¶çš„ï¼Œchannel å¯ä»¥å®£å‘Šæˆ &lt;strong>buffered channel&lt;/strong>ï¼Œä¸€å€‹ buffered channel è£¡çš„å€¼å¯ä»¥ä¿å­˜èµ·ä¾†ï¼Œæ¥å—ç«¯åªè¦æ‹¿çš„åˆ°å€¼å°±å¯ä»¥ç¹¼çºŒï¼Œç™¼é€ç«¯åªè¦ç™¼é€å€¼é€²å»å¾Œ channel æ²’æœ‰è¶…éå®¹é‡ä¹Ÿå¯ä»¥ç¹¼çºŒã€‚&lt;/p>
&lt;p>buffered channel çš„å®¹é‡é€é &lt;code>make()&lt;/code> çš„ç¬¬äºŒå€‹åƒæ•¸æŒ‡å®šï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">ch&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">make&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kd">chan&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>å°‡ä¸Šé¢æœƒé€ æˆ deadlock çš„ channel æ”¹æˆ buffered channel (size = 1) ï¼Œå°±å¯ä»¥æ­£å¸¸åŸ·è¡Œäº†ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">ch&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">make&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kd">chan&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// create a buffered channel for int
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="nx">v&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">100&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Sending v to channel&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">ch&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nx">v&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">recv&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nx">ch&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;recv: %v&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">recv&lt;/span>&lt;span class="p">)&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;h3>Close the channel&lt;span class="hx-absolute -hx-mt-20" id="close-the-channel">&lt;/span>
&lt;a href="#close-the-channel" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;ul>
&lt;li>Sender å¯ä»¥é€é &lt;code>close(channel)&lt;/code> é€šçŸ¥ receiver ä¹‹å¾Œä¸æœƒå‚³æ±è¥¿åˆ°é€™å€‹ channel ä¸­äº†ã€‚&lt;/li>
&lt;li>Receiver å¯ä»¥é€é &lt;code>v, ok := &amp;lt;- ch&lt;/code> çš„ &lt;code>ok&lt;/code> æ˜¯ &lt;code>false&lt;/code> å¾—çŸ¥ channel å·²è¢«é—œé–‰ï¼Œä¹Ÿå¯ä»¥é€é &lt;code>for i := range c&lt;/code> æ¥å—å€¼ï¼Œç›´åˆ° channel è¢«é—œé–‰ã€‚&lt;/li>
&lt;/ul>
&lt;h2>Select&lt;span class="hx-absolute -hx-mt-20" id="select">&lt;/span>
&lt;a href="#select" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;ul>
&lt;li>&lt;code>select&lt;/code> å¯ä»¥å¾å¤šå€‹ case ä¸­åŸ·è¡Œç¬¦åˆçš„æ“ä½œã€‚&lt;/li>
&lt;li>å¦‚æœåŒæ™‚æœ‰å¤šå€‹æ¢ä»¶éƒ½ç¬¦åˆï¼Œéš¨æ©Ÿé¸ä¸€å€‹ã€‚&lt;/li>
&lt;li>&lt;code>select&lt;/code> ï¼ˆåœ¨æ²’æœ‰å®šç¾© &lt;code>default&lt;/code> æ™‚ï¼‰ï¼Œæœƒ block ä¸¦ç­‰å¾…æŸå€‹ case ä¸¦åŸ·è¡Œå°æ‡‰çš„æ“ä½œï¼š&lt;/li>
&lt;li>&lt;code>select&lt;/code> åŠ ä¸Š &lt;code>default&lt;/code> å¾Œå°±ä¸æœƒ blockï¼Œå› ç‚ºç•¶å…¶ä»– channel éƒ½é‚„æ²’å¥½æ™‚ï¼Œæœƒé€²åˆ° &lt;code>default&lt;/code> ä¸­ï¼Œè¦‹&lt;a href="https://go.dev/tour/concurrency/6" target="_blank" rel="noopener">å®˜æ–¹ç¯„ä¾‹&lt;/a>åƒè€ƒï¼š&lt;/li>
&lt;/ul>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">tick&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Tick&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">100&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Millisecond&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">boom&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">After&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">500&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Millisecond&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">select&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">case&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span>&lt;span class="nx">tick&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;tick.&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">case&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span>&lt;span class="nx">boom&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;BOOM!&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">default&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34; .&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Sleep&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">50&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Millisecond&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;hr>
&lt;h2>Refs&lt;span class="hx-absolute -hx-mt-20" id="refs">&lt;/span>
&lt;a href="#refs" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;ul>
&lt;li>&lt;a href="https://go.dev/tour/concurrency/2" target="_blank" rel="noopener">A Tour of Go&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://draveness.me/golang/docs/part2-foundation/ch05-keyword/golang-select/" target="_blank" rel="noopener">Go è¯­è¨€ select çš„å®ç°åŸç† | Go è¯­è¨€è®¾è®¡ä¸å®ç° (draveness.me)&lt;/a>&lt;/li>
&lt;/ul></description></item></channel></rss>